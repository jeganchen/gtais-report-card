# PS Report Card

**GTIIT Affiliated International School** - æ±•å¤´å¸‚å¹¿ä¸œä»¥è‰²åˆ—ç†å·¥å­¦é™¢é™„å±å¤–ç±äººå‘˜å­å¥³å­¦æ ¡

å­¦ç”ŸæŠ¥å‘Šå¡ç®¡ç†ç³»ç»Ÿ - ç”¨äºç”Ÿæˆå’Œç®¡ç†å­¦ç”Ÿå­¦å¹´æŠ¥å‘Šå¡ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ” **è®¤è¯ç³»ç»Ÿ**ï¼šæ”¯æŒç”¨æˆ·å/å¯†ç ç™»å½•å’Œ Office 365 SSO
- ğŸ“‹ **å­¦ç”Ÿåˆ—è¡¨**ï¼šæŸ¥çœ‹å½“å‰å­¦æœŸæ‰€æœ‰å­¦ç”Ÿï¼Œæ”¯æŒæœç´¢å’Œç­›é€‰
- ğŸ“„ **æŠ¥å‘Šé¢„è§ˆ**ï¼šé¢„è§ˆå­¦ç”Ÿå®Œæ•´æŠ¥å‘Šå¡ï¼ŒåŒ…å«è€ƒå‹¤å’Œå­¦ç§‘è¯„ä»·
- ğŸ“‘ **PDFç”Ÿæˆ**ï¼šä¸€é”®ç”ŸæˆPDFæ ¼å¼çš„æŠ¥å‘Šå¡
- ğŸ“§ **æ‰¹é‡å‘é€**ï¼šé€‰æ‹©å¤šä¸ªå­¦ç”Ÿï¼Œæ‰¹é‡å‘é€æŠ¥å‘Šå¡åˆ°å®¶é•¿é‚®ç®±
- ğŸ”„ **PowerSchoolåŒæ­¥**ï¼šå®æ—¶ä»PowerSchoolè·å–å­¦ç”Ÿã€æˆç»©å’Œè€ƒå‹¤æ•°æ®
- ğŸ’¾ **æ•°æ®åº“å­˜å‚¨**ï¼šä½¿ç”¨MySQLæŒä¹…åŒ–å­˜å‚¨æ•°æ®

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Next.js 15 (App Router)
- **è¯­è¨€**: TypeScript 5
- **æ ·å¼**: Tailwind CSS 4
- **è®¤è¯**: NextAuth.js v5
- **çŠ¶æ€ç®¡ç†**: Zustand
- **æ•°æ®åº“**: MySQL + Prisma ORM
- **PDFç”Ÿæˆ**: @react-pdf/renderer
- **é‚®ä»¶æœåŠ¡**: Resend
- **HTTPå®¢æˆ·ç«¯**: Axios

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. æ•°æ®åº“é…ç½®

ç¡®ä¿MySQLæœåŠ¡è¿è¡Œä¸­ï¼Œç„¶ååˆ›å»ºæ•°æ®åº“ï¼š

```sql
CREATE DATABASE grais_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 3. ç¯å¢ƒé…ç½®

åˆ›å»º `.env.local` æ–‡ä»¶ï¼š

```env
# æ•°æ®åº“é…ç½®
DATABASE_URL="mysql://root:Rainbow@123@localhost:3306/grais_db"

# å¯ç”¨æ•°æ®åº“æ¨¡å¼ï¼ˆè®¾ä¸ºfalseåˆ™ä½¿ç”¨Mockæ•°æ®ï¼‰
USE_DATABASE="true"

# NextAuth é…ç½®
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your-secret-key-generate-with-openssl

# Azure AD (Office 365 ç™»å½•) - å¯é€‰
AZURE_AD_CLIENT_ID=your-client-id
AZURE_AD_CLIENT_SECRET=your-client-secret
AZURE_AD_TENANT_ID=your-tenant-id

# PowerSchool API - å¯åœ¨Settingsé¡µé¢é…ç½®
POWERSCHOOL_ENDPOINT=https://your-powerschool.com
POWERSCHOOL_CLIENT_ID=your-client-id
POWERSCHOOL_CLIENT_SECRET=your-client-secret
POWERSCHOOL_SCHOOL_ID=your-school-id

# é‚®ä»¶æœåŠ¡ - å¯åœ¨Settingsé¡µé¢é…ç½®
RESEND_API_KEY=your-resend-api-key
EMAIL_FROM=noreply@gtiit-school.edu.cn
```

### 4. åˆå§‹åŒ–æ•°æ®åº“

```bash
# ç”ŸæˆPrismaå®¢æˆ·ç«¯
npm run db:generate

# æ¨é€æ•°æ®åº“Schema
npm run db:push

# æˆ–è€…ä½¿ç”¨è„šæœ¬ä¸€é”®è®¾ç½®
chmod +x scripts/setup-db.sh
./scripts/setup-db.sh
```

### 5. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—® [http://localhost:3000](http://localhost:3000)

## æ•°æ®åº“å‘½ä»¤

```bash
# ç”ŸæˆPrismaå®¢æˆ·ç«¯
npm run db:generate

# æ¨é€Schemaåˆ°æ•°æ®åº“ï¼ˆå¼€å‘ï¼‰
npm run db:push

# åˆ›å»ºè¿ç§»ï¼ˆå¼€å‘ï¼‰
npm run db:migrate

# éƒ¨ç½²è¿ç§»ï¼ˆç”Ÿäº§ï¼‰
npm run db:migrate:prod

# æ‰“å¼€æ•°æ®åº“ç®¡ç†ç•Œé¢
npm run db:studio
```

## æµ‹è¯•è´¦å·

å¼€å‘ç¯å¢ƒä¸‹å¯ä½¿ç”¨ä»¥ä¸‹æµ‹è¯•è´¦å·ï¼š

| è§’è‰² | é‚®ç®± | å¯†ç  |
|------|------|------|
| Admin | admin@school.edu | admin123 |
| Teacher | teacher@school.edu | teacher123 |

## é¡¹ç›®ç»“æ„

```
ps-report-card/
â”œâ”€â”€ app/                      # Next.js App Router
â”‚   â”œâ”€â”€ (auth)/              # è®¤è¯ç›¸å…³é¡µé¢
â”‚   â”‚   â””â”€â”€ login/           # ç™»å½•é¡µ
â”‚   â”œâ”€â”€ (dashboard)/         # ä¸»åº”ç”¨é¡µé¢
â”‚   â”‚   â”œâ”€â”€ students/        # å­¦ç”Ÿåˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ report/[id]/     # æŠ¥å‘Šé¢„è§ˆ
â”‚   â”‚   â””â”€â”€ settings/        # ç³»ç»Ÿè®¾ç½®
â”‚   â””â”€â”€ api/                 # API è·¯ç”±
â”‚       â”œâ”€â”€ students/        # å­¦ç”ŸAPI
â”‚       â”œâ”€â”€ sync/            # åŒæ­¥API
â”‚       â”œâ”€â”€ settings/        # è®¾ç½®API
â”‚       â””â”€â”€ powerschool/     # PowerSchool API
â”œâ”€â”€ components/              # React ç»„ä»¶
â”‚   â”œâ”€â”€ ui/                  # åŸºç¡€ UI ç»„ä»¶
â”‚   â”œâ”€â”€ auth/                # è®¤è¯ç»„ä»¶
â”‚   â”œâ”€â”€ students/            # å­¦ç”Ÿç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ report/              # æŠ¥å‘Šç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ settings/            # è®¾ç½®ç»„ä»¶
â”‚   â””â”€â”€ layout/              # å¸ƒå±€ç»„ä»¶
â”œâ”€â”€ lib/                     # å·¥å…·åº“
â”‚   â”œâ”€â”€ auth.ts              # NextAuth é…ç½®
â”‚   â”œâ”€â”€ database/            # æ•°æ®åº“å±‚
â”‚   â”‚   â”œâ”€â”€ client.ts        # Prismaå®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ repositories/    # æ•°æ®ä»“åº“
â”‚   â”œâ”€â”€ powerschool/         # PowerSchoolå¯¹æ¥å±‚
â”‚   â”‚   â”œâ”€â”€ client.ts        # HTTPå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ token-manager.ts # Tokenç®¡ç†
â”‚   â”‚   â”œâ”€â”€ types.ts         # ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ transformer.ts   # æ•°æ®è½¬æ¢
â”‚   â”‚   â””â”€â”€ api/             # APIå°è£…
â”‚   â””â”€â”€ services/            # ä¸šåŠ¡æœåŠ¡å±‚
â”‚       â”œâ”€â”€ student.service.ts
â”‚       â””â”€â”€ sync.service.ts
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma        # æ•°æ®åº“æ¨¡å‹
â”œâ”€â”€ types/                   # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ mocks/                   # Mock æ•°æ®
â”œâ”€â”€ stores/                  # Zustand çŠ¶æ€ç®¡ç†
â”œâ”€â”€ plugin/                  # PowerSchool Pluginé…ç½®
â”‚   â”œâ”€â”€ plugin.xml
â”‚   â””â”€â”€ queries_root/
â””â”€â”€ public/
    â””â”€â”€ GTAIS.png            # å­¦æ ¡Logo
```

## PowerSchoolå¯¹æ¥æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯ (Next.js Pages)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      API Routes Layer                        â”‚
â”‚  /api/students  /api/sync  /api/attendance  /api/grades     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Service Layer                             â”‚
â”‚  StudentService  GradeService  AttendanceService  SyncServiceâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 Repository Layer (Prisma)                    â”‚
â”‚  StudentRepo  GradeRepo  AttendanceRepo  SettingsRepo       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    MySQL Database                            â”‚
â”‚                     (grais_db)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†• å®æ—¶åŒæ­¥
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               PowerSchool Client Layer                       â”‚
â”‚  TokenManager  StudentAPI  GradeAPI  AttendanceAPI          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 PowerSchool Server                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## APIç«¯ç‚¹

| è·¯ç”± | æ–¹æ³• | æè¿° |
|------|------|------|
| `/api/students` | GET | è·å–å­¦ç”Ÿåˆ—è¡¨ |
| `/api/students/[id]` | GET | è·å–å­¦ç”Ÿè¯¦æƒ… |
| `/api/students/[id]/grades` | GET | è·å–å­¦ç”Ÿæˆç»© |
| `/api/students/[id]/attendance` | GET | è·å–å­¦ç”Ÿè€ƒå‹¤ |
| `/api/students/[id]/report` | GET | è·å–å®Œæ•´æŠ¥å‘Šæ•°æ® |
| `/api/sync` | GET | è·å–åŒæ­¥çŠ¶æ€ |
| `/api/sync` | POST | è§¦å‘æ•°æ®åŒæ­¥ |
| `/api/settings` | GET/PUT | ç³»ç»Ÿè®¾ç½® |
| `/api/powerschool/token` | POST | è·å–PS Token |

## æŠ¥å‘Šå¡å†…å®¹

æŠ¥å‘Šå¡åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

1. **é¡µçœ‰**ï¼šå­¦æ ¡ Logo å’Œåç§° (GTIIT Affiliated International School)
2. **å­¦ç”Ÿä¿¡æ¯**ï¼šå­¦å·ã€å§“åã€å¹´çº§ã€ç­çº§ã€æ—¥æœŸ
3. **è€ƒå‹¤æ±‡æ€»**ï¼šæŒ‰å­£åº¦(Q1-Q4)ç»Ÿè®¡ç¼ºå‹¤å’Œè¿Ÿåˆ°
4. **è¯„åˆ†è¯´æ˜ (Assessment Key)**ï¼š
   - E = Exemplary (ä¼˜ç§€)
   - P = Proficient (ç†Ÿç»ƒ)
   - A = Approaching (æ¥è¿‘)
   - N = Not Yet (å°šæœª)
   - \- = æœªè¯„ä¼°
5. **å­¦ç§‘è¯„ä»·**ï¼šæ¯ä¸ªå­¦ç§‘çš„ Standards å’Œå­£åº¦è¯„åˆ†
6. **é¡µè„š**ï¼šæ ¡é•¿ç­¾åã€å­¦æ ¡è”ç³»ä¿¡æ¯

## ä¸»é¢˜è‰²

åº”ç”¨ä½¿ç”¨ GTIIT å­¦æ ¡å“ç‰Œç´«è‰²ä¸»é¢˜ï¼š

- ä¸»è‰²: `#6b2d5b`
- æµ…è‰²: `#f5eaf3`
- æ·±è‰²: `#2d1226`

## å¼€å‘è¿›åº¦

- [x] é¡¹ç›®åŸºç¡€æ¶æ„
- [x] è®¤è¯ç³»ç»Ÿ
- [x] å­¦ç”Ÿåˆ—è¡¨é¡µé¢
- [x] æŠ¥å‘Šé¢„è§ˆé¡µé¢
- [x] ç³»ç»Ÿè®¾ç½®é¡µé¢
- [x] PowerSchoolå¯¹æ¥å±‚
- [x] MySQLæ•°æ®åº“é›†æˆ
- [x] æ•°æ®åŒæ­¥æœåŠ¡
- [ ] çœŸå®PDFç”Ÿæˆ
- [ ] é‚®ä»¶æœåŠ¡é›†æˆ
- [ ] è§’è‰²æƒé™ç®¡ç† (RBAC)
- [ ] å¤šå­¦å¹´æ”¯æŒ

## License

Private - GTIIT Affiliated International School
